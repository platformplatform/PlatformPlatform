---
description: Workflow for create technical tasks for all product increments in a prd
globs: 
alwaysApply: false
---
# Create Tasks Workflow

PRD file: $ARGUMENTS

Read the PRD file provided in the arguments above and identify ALL Product Increments listed in it. Your job is to create technical tasks for each Product Increment.

The goal is to create `./.workspace/task-manager/yyyy-MM-dd-[prd-title]/[#-product-increment-title].md` files with low-level technical tasks for each Product Increment. The date prefix should match the PRD's directory date.

## Workflow

Follow the steps below to create tasks for all Product Increments.

0. Identify Product Increments and create todo list

   - Read the PRD and identify all Product Increments listed in the "Product Increments" section
   - Create a todo list with one item per Product Increment (e.g., "Plan Product Increment 1: Backend", "Plan Product Increment 2: Frontend")
   - For each Product Increment, follow steps 1-4 below

1. Create Product Increment header and description

  - Create a Product Increment file `./.workspace/task-manager/yyyy-MM-dd-[prd-title]/[#-product-increment-title].md`, where the date prefix matches the PRD's directory date, and the `#` and `product-increment-title` is the same as used in the PRD's "Product Increments" section.
  - At the top of each Product Increment file include:
    - **Level 1 header**: This should match the Product Increment title from the PRD (e.g., "Backend for team management").
    - **Purpose:**  a short description of what this Product Increment delivers and the features it contains.
    - **NOT included:** out-of-scope items.
    - **Dependencies:** previous Product Increments or external requirements.
    - **IMPORTANT:** warning not to work outside this scope.

2. Break Product Increment into tasks

   **CRITICAL: A task = one commit = one complete vertical slice**

   ### Vertical slice definition:
   
   **Backend vertical slice must include:**
   - Database changes (if needed)
   - Domain model/aggregate changes
   - A single command or query implementation  
   - API single endpoint
   - API tests
   - All in ONE task that results in ONE commit

   **Frontend vertical slice must include:**
   - Component creation
   - API integration (TanStack Query)
   - State management
   - User interactions
   - All in ONE task that results in ONE commit

   **WRONG approach (multiple tasks/commits):**
   - Task 1: Add database field ❌
   - Task 2: Update domain model ❌
   - Task 3: Create command ❌
   - Task 4: Add API endpoint ❌
   - Task 5: Write tests ❌

   **RIGHT approach (vertical slice):**
   - Task 1: Create complete GetTeam query with repository method, query handler, API endpoint, and tests ✅

   Since we prefer API tests, a commit with tests is a full vertical slice.

   ### Task guidelines:
   - The first task for a new feature is often larger (includes migration, aggregate, command, endpoint, tests)
   - Subsequent tasks can be smaller (e.g., just adding a query with its endpoint and tests)
   - Keep CRUD operations separate: Create in one task, Read in another, Update in another, Delete in another
   - Never have multiple commands or queries in one task
   - Never have mulitple API endpoints in one task
   - Prefix each task with a level-2 header followed by [Planned], for example `## 1 Create GetTeam query [Planned]`
   - Use "Sentence case" not "Title Case" for task headers

   > Note: Each task must result in code that compiles, runs, and can be tested independently

3. Add subtasks

   ### Precision without code lock-in:
   
   **BE PRECISE about:**
   - Class names, method names, property names
   - API endpoints and routes
   - Validation rules and business logic
   - Database schema and relationships
   - What guards and permissions to check
   
   **DON'T INCLUDE:**
   - Actual code syntax or snippets
   - Specific implementation details that might change
   - Technology-specific configurations
   - Detailed error messages
   
   **Good subtask example:**
   ```
   2.1 Create `UpdateTeam` command
     - Validate name length (≤ 50 Unicode chars)
     - Guard tenant Owner permission only
     - Check name uniqueness via repository
   ```
   
   **Bad subtask example (too much code detail):**
   ```
   2.1 Create UpdateTeam command
     - Add RuleFor(x => x.Name).Length(1, 50).WithMessage("...")
     - if (executionContext.UserInfo.Role != UserRole.Owner) return Result.Forbidden()
   ```

   ### Subtask guidelines:
   - For each task add small subtasks for each implementation step
   - Prefix each subtask with a number, for example `1.1 Create Team aggregate`
   - Focus on WHAT to implement, not HOW to code it
   - Let the implementation phase consult rules for exact patterns
   - Use `backticks` for names of classes, properties, file names
   - Avoid modifying `shared-kernel` or `shared-webapp` unless explicitly agreed

4. Save Product Increment files

   Save all Product Increment files under `./.workspace/task-manager/yyyy-MM-dd-[prd-title]/[#-product-increment-title].md`.

5. Tools available:

   - Perplexity MCP tool for research on complex implementation questions.
   - Context7 MCP tool for up-to-date best practices and technology updates.

## Example

Using these examples, to understand how to write tasks and subtasks for Product Increments:

- [Backend for team management](mdc:.cursor/samples/1-backend-sample.mdc)
- [Frontend for team management](mdc:.cursor/samples/2-frontend-sample.mdc)

## ✅ DO:

- Create one file per Product Increment under `./.workspace/task-manager/yyyy-MM-dd-[prd-title]/`.
- Keep tasks focused on the smallest vertical slices with API tests and one commit per task.

## ❌ DON'T:

- Skip research – always read existing code and rules before writing tasks and subtasks.
- Combine multiple commands or queries into one task or combine frontend and backend tasks into one.
- Create separate tasks for tests. Test should be part of the task.
- Create tasks that cannot be tested in isolation (for example, a command without an API endpoint).
- Include implementation details that cannot be built or tested in one commit.
- Create tasks that depend on details that will be implemented later.
- Modify `shared-kernel` or `shared-webapp` without explicit agreement.
- Create or delete Product Increment files outside `./.workspace/task-manager/yyyy-MM-dd-[prd-title]/`.
- Write titles in Title Case. Instead always use sentence case.
